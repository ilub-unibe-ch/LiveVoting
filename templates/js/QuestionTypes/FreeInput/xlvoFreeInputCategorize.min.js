var xlvoFreeInputCategorize={drake:null,base_url:"",request_pending:!1,debug:!1,init:function(a){this.base_url=a,this.initDragula(),this.initButtons(),this.initialized=!0,$("div.ilTabsContentOuter").append($("#srag_waiter")),this.log("xlvoFreeInputCategorize initialized")},initDragula:function(){this.drake=dragula($.find("div.bars"),{moves:function(a){return $(a).is("div")},accepts:function(a,b,c){return b!==c},mirrorContainer:$("div.ilTabsContentOuter")[0]}).on("drag",function(){xlvoFreeInputCategorize.recalculatePlayerHeight()}).on("drop",function(a,b){xlvoFreeInputCategorize.changeCategory($(a).find("div.xlvo-vote-free-input")[0].getAttribute("data-vote-id"),$(b).parent().attr("data-category-id")),xlvoFreeInputCategorize.recalculatePlayerHeight()})},initButtons:function(){$("input.category_input:last").on("keypress",function(a){13==a.which&&xlvoFreeInputCategorize.addCategory()}),$("button.category_button:last").on("click",xlvoFreeInputCategorize.addCategory),$("input.answer_input:last").on("keypress",function(a){13==a.which&&xlvoFreeInputCategorize.addAnswer()}),$("button.answer_button:last").on("click",xlvoFreeInputCategorize.addAnswer)},addCategory:function(){return xlvoFreeInputCategorize.isRequestPending()?void this.log("Request Pending"):void(xlvoFreeInputCategorize.startRequest(),$.post(xlvoPlayer.config.base_url+"&cmd=apiCall",{call:"add_category",title:$("#category_input").val()}).done(function(a){$("div#categories").append("<div id=\"category_id_"+a.category_id+"\" class=\"col-md-4\" data-category-id=\""+a.category_id+"\"><button type=\"button\" class=\"close\" aria-label=\"Close\" onClick=\"xlvoFreeInputCategorize.removeCategory($(this).parent());\"><span aria-hidden=\"true\">&times;</span></button><fieldset class=\"well xlvo-category category_dropzone\" data-category-id=\""+a.category_id+"\"><legend>"+$("#category_input").val()+"</legend><br><div id=\"bars_"+a.category_id+"\" class=\"bars\"><div class=\"col-md-4\"></div></div></fieldset></div>"),console.log($("#bars_"+a.category_id)[0]),xlvoFreeInputCategorize.drake.containers.push($("#bars_"+a.category_id)[0]),$("#category_input").val(""),xlvoFreeInputCategorize.recalculatePlayerHeight()}).always(function(){xlvoFreeInputCategorize.endRequest()}))},removeCategory:function(a){return xlvoFreeInputCategorize.isRequestPending()?void this.log("Request Pending"):void(xlvoFreeInputCategorize.startRequest(),category_id=$(a).attr("data-category-id"),$.post(xlvoPlayer.config.base_url+"&cmd=apiCall",{call:"remove_category",category_id:category_id}).done(function(){a.remove(),xlvoFreeInputCategorize.recalculatePlayerHeight()}).always(function(){xlvoFreeInputCategorize.endRequest()}))},addAnswer:function(){return xlvoFreeInputCategorize.isRequestPending()?void this.log("Request Pending"):void(xlvoFreeInputCategorize.startRequest(),$.post(xlvoPlayer.config.base_url+"&cmd=apiCall",{call:"add_vote",input:$("#answer_input").val()}).done(function(a){$("div#bars").append("<div class=\"col-md-4\"><div id=\"vote_id_"+a.vote_id+"\" class=\"xlvo-vote-free-input\" data-vote-id=\""+a.vote_id+"\"><button type=\"button\" class=\"close\" aria-label=\"Close\" onClick=\"xlvoFreeInputCategorize.removeAnswer($(this).parent().parent())\"><span aria-hidden=\"true\">&times;</span></button><div class=\"well well-sm\"><span>"+$("#answer_input").val()+"</span></div></div></div>"),$("#answer_input").val(""),xlvoFreeInputCategorize.recalculatePlayerHeight()}).always(function(){xlvoFreeInputCategorize.endRequest()}))},removeAnswer:function(a){return xlvoFreeInputCategorize.isRequestPending()?void this.log("Request Pending"):void(xlvoFreeInputCategorize.startRequest(),vote_id=$(a).find("div.xlvo-vote-free-input")[0].getAttribute("data-vote-id"),$.post(xlvoPlayer.config.base_url+"&cmd=apiCall",{call:"remove_vote",vote_id:vote_id}).done(function(){$(a).remove(),xlvoFreeInputCategorize.recalculatePlayerHeight()}).always(function(){xlvoFreeInputCategorize.endRequest()}))},changeCategory:function(a,b){return xlvoFreeInputCategorize.isRequestPending()?void this.log("Request Pending"):void(xlvoFreeInputCategorize.startRequest(),$.post(xlvoPlayer.config.base_url+"&cmd=apiCall",{call:"change_category",vote_id:a,category_id:"undefined"===b?0:b}).done(function(){}).always(function(){xlvoFreeInputCategorize.endRequest()}))},recalculatePlayerHeight:function(){var a=$("#xlvo-display-player").children();$("#xlvo-display-player").css("height",a.css("height"))},startRequest:function(){il.waiter.show(),xlvoFreeInputCategorize.request_pending=!0},endRequest:function(){il.waiter.hide(),xlvoFreeInputCategorize.request_pending=!1},isRequestPending:function(){return xlvoFreeInputCategorize.request_pending},log:function(a){this.debug&&console.log(a)},debug:function(){this.debug=!0},stop:function(){this.debug=!1}};